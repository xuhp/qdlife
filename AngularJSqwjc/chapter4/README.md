#第4章 作用域
 应用的作用域是和应用的数据模型相关联的，同时作用域也是表达式执行的上下文。$scope 对象是定义应用业务逻辑、控制器方法和视图属性的地方。

 作用域是应用状态的基础。基于动态绑定，我们可以依赖视图在修改数据时立刻更新 $scope ,也可以依赖 $scope 在其发生变化时立刻重新渲染试图。
 
 作用域提供了监视数据模型变化的能力。
 
 将应用的业务逻辑都放在控制器中，而将相关的数据都放在控制器的作用域中。
 
##4.1 视图和$scope的世界

 AngualrJS 在启动并生成视图时，会将根ng-app元素同$rootScope进行绑定。$rootScope 是所有 $scope 对象的最上层。
 
 $scope 对象就是一个普通的 JavaScript 对象，我们可以再其上随意修改或添加属性。
 
 $scope对象在AngualrJS中充当数据模型，但与传统的数据模型不一样，$scope并不负责处理和操作数据，它只是视图和HTML之间的桥梁。它是视图和控制器之间的胶水
 
```
	<div ng-app="myApp">
		<h1>Hello {{ name }}</h1>
	</div>
	
	angular.module('myApp', [])
		.run(function($rootScope) {
			$rootScope.name = 'World';
		})
	
```

##4.2 就是 HTML 而已

AngularJS 不会对不包含 AngularJS 特殊声明的元素进行任何处理。

我们可以在 AngularJS 应用的模板中使用多种标记:

- 指令： 将DOM元素增强为可复用的DOM组件的属性或元素。
- 值绑定： 模板语法 {{}} 可以将表达式绑定到视图上。
- 过滤器： 可以在视图中使用函数，用来进行格式化。
- 表单控件： 用来检验用户输入的控件。

##4.3 作用域能做什么

作用域的基本功能：

- 提供观察者以监视数据模型的变化；
- 可以将数据模型的变化通知给整个应用，甚至是系统外的组件；
- 可以进行嵌套，隔离业务功能和数据；
- 给表达式提供运算时所需的执行环境。

> 作用域包含了渲染视图时所需的功能和数据，它是所有视图的唯一源头。可以将作用域理解成视图模型（view model）

使用ng-controller指令可以将一个控制器对象附加到DOM元素上。

```
	<div ng-app="myApp">
		<h1>Hello {{ name }}</h1>
	</div>
	
```

创建一个控制器来管理与其相关的变量，而不用将name变量直接放在$rootScope上：

```
	angular.module('myApp', [])
	.controller('MyController',
	function($scope) {
		$scope.name = 'Ari';
	})
```

ng-controller指令为这个DOM元素创建了一个新的$scope对象，并将它嵌套在$rootScope中。

##4.4 $scope的生命周期

当Angular关心的事件发生在浏览器中时，比如用户在通过ng-model属性监控的输入字段中输入，或者带有ng-click属性的按钮被点击时，Angualr的事件循环都会启动。这个事件将在Angualr执行上下文中处理。

每当事件被处理时，$scope就会对定义的表达式求值。此时事件循环会启动，并且Anguar应用会监控应用程序内所有对象，脏值检测循环也会运行。

###4.4.1 创建

在创建控制器或指令时，AngualrJS 会用 $injector 创建一个新的作用域，并在这个新建的控制器或指令运行时将作用域传递进去。

###4.4.2 链接

当Angualr开始运行时，所有的$scope对象都会附加或者链接到视图中。所有创建$scope对象的函数也会将自身附加到视图中。这些作用域将会注册当Angualr应用上下文中发生变化时需要运行的函数。

> 这些函数被称为$watch函数，Angular通过这些函数获知何时启动事件循环。

###4.4.3 更新

当事件循环运行时，它通常执行在顶层$scope对象上（被称作$rootScope）,每个子作用域都执行自己的脏值检测。每个监控函数都会检查变化。如果检测到任意变化，$scope对象就会触发指定的回掉函数。

###4.4.4 销毁

当一个$scope在视图中不再需要时，这个作用域将会清理和销毁自己。

$destory()

##4.5 指令和作用域

 


































